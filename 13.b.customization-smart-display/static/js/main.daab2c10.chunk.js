(this["webpackJsonpsample-customization-smart-display"]=this["webpackJsonpsample-customization-smart-display"]||[]).push([[0],{1253:function(e,t){},1254:function(e,t){},1255:function(e,t){},1420:function(e,t){},1430:function(e,t){},1431:function(e,t){},1432:function(e,t){},1447:function(e,t){},1455:function(e,t,n){},1456:function(e,t,n){},1457:function(e,t,n){},1458:function(e,t,n){},1459:function(e,t,n){},1460:function(e,t,n){},1461:function(e,t,n){"use strict";n.r(t);n(566),n(567),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a,c=n(38),o=n.n(c),r=n(28),i=n(39),s=n(1),u=n.n(s),l=3e5,p=0;function m(){var e;return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Date.now(),(!a||e-p>l)&&(a=fetch("https://webchat-mockbot-streaming.azurewebsites.net/speechservices/token",{method:"POST"}).then((function(e){return e.json()})).then((function(e){var t=e.region;return{authorizationToken:e.token,region:t}})).catch((function(){p=0})),p=e),t.abrupt("return",a);case 3:case"end":return t.stop()}}))}var f=m,h=(n(1455),n(12)),v=n.n(h),d=i.hooks.useSendBoxSpeechInterimsVisible,b=function(){var e=d(),t=Object(r.a)(e,1)[0];return u.a.createElement("div",{className:v()("App-BlurLens",{hide:!t})})},E=(n(1456),n(107)),k=n.n(E),j=i.hooks.useActivities;function O(){var e=j();return[Object(r.a)(e,1)[0].slice().reverse().find((function(e){var t=e.from.role,n=e.type;return"bot"===t&&"message"===n}))]}var w=i.Components.SpeakActivity,A=i.hooks.useSendBoxSpeechInterimsVisible,y=function(e){var t=e.lastReadActivityID,n=A(),a=Object(r.a)(n,1)[0],c=O(),o=Object(r.a)(c,1)[0],l=Object(s.useMemo)((function(){return Object(i.createAdaptiveCardsAttachmentMiddleware)()()((function(){return!1}))}),[]);return!a&&!!o&&o.id!==t&&u.a.createElement("div",{className:"App-BotResponse"},!!o.text&&u.a.createElement("div",{className:"App-BotResponse-Activity"},o.text),u.a.createElement(k.a,{className:"App-BotResponse-Attachments",showScrollBar:!1},(o.attachments||[]).map((function(e,t){return u.a.createElement("div",{className:"App-BotResponse-Attachment",key:t},l({activity:o,attachment:e}))}))),o.channelData&&o.channelData.speak&&u.a.createElement(w,{activity:o}))},S=(n(1457),n(1458),function(e){var t=e.children,n=e.icon;return u.a.createElement("div",{className:"App-Notification"},u.a.createElement("i",{className:v()("App-Notification-Icon","ms-Icon","ms-Icon--".concat(n))}),u.a.createElement("div",{className:"App-Notification-Text"},t))});var I=function(){var e=Object(s.useState)(Date.now()),t=Object(r.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(),i=Object(r.a)(c,2),l=i[0],p=i[1];return Object(s.useEffect)((function(){!function(){var e,t,n,a;o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,o.a.awrap(fetch("https://api.weather.gov/gridpoints/SEW/130,67/forecast",{headers:{accept:"application/geo+json"}}));case 2:if(!(e=c.sent).ok){c.next=10;break}return c.next=6,o.a.awrap(e.json());case 6:t=c.sent,n=Object(r.a)(t.properties.periods,1),a=n[0],p(a.temperature);case 10:case"end":return c.stop()}}))}()}),[]),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(s.useEffect)((function(){if(e&&t){var n=setInterval(e,t);return function(){return clearInterval(n)}}}),[e,t])}((function(){return a(Date.now())}),1e3),u.a.createElement("div",{className:"App-Clock"},u.a.createElement("div",{className:"App-Clock-Text"},Intl.DateTimeFormat("en-US",{hour12:!1,timeStyle:"short"}).format(new Date(n))),!!l&&u.a.createElement(S,{icon:"PartlyCloudyDay"},l,"\xb0F"),u.a.createElement(S,{icon:"Mail"},"2"),u.a.createElement(S,{icon:"SkypeForBusinessLogo"},"1"))},N=(n(1459),i.hooks.useMicrophoneButtonClick),x=i.hooks.useMicrophoneButtonDisabled,B=i.hooks.useSendBoxSpeechInterimsVisible,g=function(e){var t=e.onClick,n=B(),a=Object(r.a)(n,1)[0],c=x(),o=Object(r.a)(c,1)[0],i=N(),l=Object(s.useCallback)((function(){i(),t&&t()}),[i,t]);return u.a.createElement("button",{className:v()("App-MicrophoneButton",{dictating:a}),disabled:o,onClick:l},u.a.createElement("i",{className:"ms-Icon ms-Icon--Microphone"}))},C=(n(1460),i.hooks.useDictateInterims),D=i.hooks.useSendBoxSpeechInterimsVisible,M=function(){var e=C(),t=Object(r.a)(e,1)[0],n=D(),a=Object(r.a)(n,1)[0];return a&&u.a.createElement("div",{className:"App-SpeechInterims"},!!a&&t.map((function(e,t){return u.a.createElement("span",{key:t},e,"\xa0")})))},R=function(){var e=O(),t=Object(r.a)(e,1)[0],n=Object(s.useState)(),a=Object(r.a)(n,2),c=a[0],o=a[1],i=Object(s.useCallback)((function(){t&&o(t.id)}),[t,o]);return u.a.createElement("div",{className:"App-SmartDisplay"},u.a.createElement(I,null),u.a.createElement(b,null),u.a.createElement(M,null),u.a.createElement(y,{lastReadActivityID:c}),u.a.createElement(g,{onClick:i}))},T=i.Components.Composer,z=function(){var e=Object(s.useState)(),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,o.a.awrap(Object(i.createDirectLineSpeechAdapters)({fetchCredentials:f}));case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}))}),[a]),!!n&&u.a.createElement(T,n,u.a.createElement(R,null))},V=n(136);n.n(V).a.render(u.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},288:function(e,t){},289:function(e,t){},563:function(e,t){},565:function(e,t,n){e.exports=n(1461)},566:function(e,t,n){},567:function(e,t,n){},672:function(e,t){},674:function(e,t){},709:function(e,t){},710:function(e,t){}},[[565,1,2]]]);
//# sourceMappingURL=main.daab2c10.chunk.js.map