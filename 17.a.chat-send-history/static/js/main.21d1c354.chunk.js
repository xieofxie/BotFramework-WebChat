(this["webpackJsonpsample-chat-send-history"]=this["webpackJsonpsample-chat-send-history"]||[]).push([[0],{1183:function(t,e){},1184:function(t,e){},1185:function(t,e){},1348:function(t,e){},1358:function(t,e){},1359:function(t,e){},1360:function(t,e){},1375:function(t,e){},1383:function(t,e,n){"use strict";n.r(e);var i=n(2),s=n.n(i),r=n(125),a=n.n(r),o=(n(534),n(0)),c=n(1),u=n(6),h=n(3),f=n(7),l=n(126),d=n.n(l),y=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Object(o.a)(this,t),this._state=[],this._index=-1,this._storageKey="WEBCHAT_SEND_HISTORY",this._persist=e,this._persist){try{this._state=JSON.parse(window.sessionStorage.getItem(this._storageKey))||[]}catch(n){this._state=[]}this.add=this._persistAfter(this.add),this.truncate=this._persistAfter(this.truncate)}}return Object(c.a)(t,[{key:"isActive",value:function(){return this._state.length>0&&this._index>-1}},{key:"add",value:function(t){var e=this._state.indexOf(t);-1!==e&&this._state.splice(e,1),this._state.unshift(t),this._state.length>25&&this.truncate()}},{key:"getNext",value:function(){var t=this._state[this._index+1];if(t)return this._index++,t}},{key:"getPrevious",value:function(){var t=this._state[this._index-1];return t?(this._index--,t):(this.reset(),"")}},{key:"reset",value:function(){this._index=-1}},{key:"truncate",value:function(){this._state.pop()}},{key:"_persistAfter",value:function(t){var e=this;return function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];t.call.apply(t,[e].concat(i)),e._persist&&window.sessionStorage.setItem(e._storageKey,JSON.stringify(e._state))}}}]),t}(),p=n(70),_=n.n(p),v=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(h.a)(e).call(this,t))).state={directLine:null},n}return Object(f.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.fetchToken()}},{key:"fetchToken",value:function(){var t,e,n;return _.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.a.awrap(fetch("https://webchat-mockbot.azurewebsites.net/directline/token",{method:"POST"}));case 2:return t=i.sent,i.next=5,_.a.awrap(t.json());case 5:e=i.sent,n=e.token,this.setState((function(){return{directLine:Object(l.createDirectLine)({token:n})}}));case 8:case"end":return i.stop()}}),null,this)}},{key:"render",value:function(){return this.state.directLine?s.a.createElement(d.a,Object.assign({className:"chat",directLine:this.state.directLine},this.props)):s.a.createElement("div",null,"Connecting to bot\u2026")}}]),e}(s.a.Component),b=function(t){function e(){var t,n;Object(o.a)(this,e);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(n=Object(u.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(s)))).history=new y,n.state={isDirty:!1},n.store=Object(l.createStore)({},(function(){return function(t){return function(e){return"WEB_CHAT/SEND_MESSAGE"===e.type?n.history.add(e.payload.text):e.fromHistory||"WEB_CHAT/SET_SEND_BOX"!==e.type||(n.setState({isDirty:""!==e.payload.text}),n.history.reset()),t(e)}}})),n.handleKeyDown=function(t){var e=t.target;if(!n.state.isDirty&&"webchat-sendbox-input"===e.dataset.id){var i;switch(t.key){case"ArrowUp":i=n.history.getNext();break;case"ArrowDown":i=n.history.getPrevious();break;default:return}"string"===typeof i&&n.store.dispatch({type:"WEB_CHAT/SET_SEND_BOX",fromHistory:!0,payload:{text:i}})}},n}return Object(f.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"app",onKeyDown:this.handleKeyDown},s.a.createElement(v,{store:this.store}))}}]),e}(s.a.Component);a.a.render(s.a.createElement(b,null),document.getElementById("root"))},265:function(t,e){},266:function(t,e){},527:function(t,e){},529:function(t,e,n){t.exports=n(1383)},534:function(t,e,n){},637:function(t,e){},639:function(t,e){},675:function(t,e){},676:function(t,e){}},[[529,1,2]]]);
//# sourceMappingURL=main.21d1c354.chunk.js.map